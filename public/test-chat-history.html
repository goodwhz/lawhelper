<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¯¹è¯å†å²åŠŸèƒ½æµ‹è¯•</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 min-h-screen p-8">
    <div class="max-w-4xl mx-auto">
        <h1 class="text-3xl font-bold text-gray-800 mb-8 text-center">ğŸ—‚ï¸ å¯¹è¯å†å²åŠŸèƒ½æµ‹è¯•</h1>

        <!-- åŠŸèƒ½æµ‹è¯•åŒºåŸŸ -->
        <div class="grid md:grid-cols-2 gap-6 mb-8">
            <!-- æœ¬åœ°å­˜å‚¨æµ‹è¯• -->
            <div class="bg-white rounded-lg shadow p-6">
                <h2 class="text-xl font-semibold text-gray-800 mb-4">ğŸ’¾ LocalStorage æµ‹è¯•</h2>
                <div class="space-y-4">
                    <button onclick="testLocalStorage()" class="w-full px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">
                        æµ‹è¯•æœ¬åœ°å­˜å‚¨åŠŸèƒ½
                    </button>
                    <button onclick="clearLocalStorage()" class="w-full px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700">
                        æ¸…é™¤æœ¬åœ°å­˜å‚¨æ•°æ®
                    </button>
                    <div id="storage-result" class="p-3 bg-gray-100 rounded text-sm"></div>
                </div>
            </div>

            <!-- ä¼šè¯ç®¡ç†æµ‹è¯• -->
            <div class="bg-white rounded-lg shadow p-6">
                <h2 class="text-xl font-semibold text-gray-800 mb-4">ğŸ“ ä¼šè¯ç®¡ç†æµ‹è¯•</h2>
                <div class="space-y-4">
                    <button onclick="createTestSessions()" class="w-full px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700">
                        åˆ›å»ºæµ‹è¯•ä¼šè¯
                    </button>
                    <button onclick="listSessions()" class="w-full px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700">
                        åˆ—å‡ºæ‰€æœ‰ä¼šè¯
                    </button>
                    <div id="session-result" class="p-3 bg-gray-100 rounded text-sm max-h-40 overflow-y-auto"></div>
                </div>
            </div>
        </div>

        <!-- åŠŸèƒ½éªŒè¯åˆ—è¡¨ -->
        <div class="bg-white rounded-lg shadow p-6 mb-8">
            <h2 class="text-xl font-semibold text-gray-800 mb-4">âœ… åŠŸèƒ½éªŒè¯æ¸…å•</h2>
            <div class="space-y-2">
                <div class="flex items-center justify-between p-3 bg-green-50 rounded border border-green-200">
                    <span class="text-gray-700">è‡ªåŠ¨ä¿å­˜å¯¹è¯åˆ°æœ¬åœ°å­˜å‚¨</span>
                    <span class="text-green-600 font-semibold">âœ“ å·²å®ç°</span>
                </div>
                <div class="flex items-center justify-between p-3 bg-green-50 rounded border border-green-200">
                    <span class="text-gray-700">åˆ›å»ºå¤šä¸ªç‹¬ç«‹å¯¹è¯ä¼šè¯</span>
                    <span class="text-green-600 font-semibold">âœ“ å·²å®ç°</span>
                </div>
                <div class="flex items-center justify-between p-3 bg-green-50 rounded border border-green-200">
                    <span class="text-gray-700">åˆ é™¤å•ä¸ªä¼šè¯åŠŸèƒ½</span>
                    <span class="text-green-600 font-semibold">âœ“ å·²å®ç°</span>
                </div>
                <div class="flex items-center justify-between p-3 bg-green-50 rounded border border-green-200">
                    <span class="text-gray-700">æ¸…ç©ºå½“å‰ä¼šè¯æ¶ˆæ¯</span>
                    <span class="text-green-600 font-semibold">âœ“ å·²å®ç°</span>
                </div>
                <div class="flex items-center justify-between p-3 bg-green-50 rounded border border-green-200">
                    <span class="text-gray-700">ä¾§è¾¹æ æ˜¾ç¤ºä¼šè¯åˆ—è¡¨</span>
                    <span class="text-green-600 font-semibold">âœ“ å·²å®ç°</span>
                </div>
                <div class="flex items-center justify-between p-3 bg-green-50 rounded border border-green-200">
                    <span class="text-gray-700">ä¼šè¯åˆ‡æ¢åŠŸèƒ½</span>
                    <span class="text-green-600 font-semibold">âœ“ å·²å®ç°</span>
                </div>
                <div class="flex items-center justify-between p-3 bg-green-50 rounded border border-green-200">
                    <span class="text-gray-700">æ™ºèƒ½ç”Ÿæˆä¼šè¯æ ‡é¢˜</span>
                    <span class="text-green-600 font-semibold">âœ“ å·²å®ç°</span>
                </div>
                <div class="flex items-center justify-between p-3 bg-green-50 rounded border border-green-200">
                    <span class="text-gray-700">æ˜¾ç¤ºæœ€åæ›´æ–°æ—¶é—´</span>
                    <span class="text-green-600 font-semibold">âœ“ å·²å®ç°</span>
                </div>
                <div class="flex items-center justify-between p-3 bg-green-50 rounded border border-green-200">
                    <span class="text-gray-700">Markdownæ ¼å¼æ”¯æŒ</span>
                    <span class="text-green-600 font-semibold">âœ“ å·²å®ç°</span>
                </div>
                <div class="flex items-center justify-between p-3 bg-green-50 rounded border border-green-200">
                    <span class="text-gray-700">å“åº”å¼è®¾è®¡é€‚é…</span>
                    <span class="text-green-600 font-semibold">âœ“ å·²å®ç°</span>
                </div>
            </div>
        </div>

        <!-- å¿«é€Ÿè®¿é—®é“¾æ¥ -->
        <div class="bg-white rounded-lg shadow p-6">
            <h2 class="text-xl font-semibold text-gray-800 mb-4">ğŸš€ å¿«é€Ÿè®¿é—®</h2>
            <div class="grid md:grid-cols-3 gap-4">
                <a href="/ai-chat-history" target="_blank" 
                   class="block p-4 bg-blue-50 border border-blue-200 rounded-lg hover:bg-blue-100 transition-colors text-center">
                    <div class="text-2xl mb-2">ğŸ’¬</div>
                    <div class="font-semibold text-blue-700">å¯¹è¯å†å²ç‰ˆ</div>
                    <div class="text-sm text-blue-600 mt-1">å®Œæ•´å†å²ç®¡ç†åŠŸèƒ½</div>
                </a>
                
                <a href="/ai-chat-enhanced" target="_blank"
                   class="block p-4 bg-green-50 border border-green-200 rounded-lg hover:bg-green-100 transition-colors text-center">
                    <div class="text-2xl mb-2">ğŸ¨</div>
                    <div class="font-semibold text-green-700">å¢å¼ºMarkdownç‰ˆ</div>
                    <div class="text-sm text-green-600 mt-1">å®Œæ•´æ ¼å¼åŒ–æ”¯æŒ</div>
                </a>
                
                <a href="/ai-chat-markdown" target="_blank"
                   class="block p-4 bg-purple-50 border border-purple-200 rounded-lg hover:bg-purple-100 transition-colors text-center">
                    <div class="text-2xl mb-2">ğŸ“</div>
                    <div class="font-semibold text-purple-700">åŸºç¡€Markdownç‰ˆ</div>
                    <div class="text-sm text-purple-600 mt-1">è½»é‡çº§æ ¼å¼åŒ–</div>
                </a>
            </div>
        </div>

        <!-- ä½¿ç”¨è¯´æ˜ -->
        <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-6 mt-8">
            <h2 class="text-xl font-semibold text-yellow-800 mb-4">ğŸ’¡ ä½¿ç”¨è¯´æ˜</h2>
            <ol class="space-y-2 text-yellow-700">
                <li>1. ç‚¹å‡»"å¯¹è¯å†å²ç‰ˆ"è¿›å…¥å®Œæ•´åŠŸèƒ½çš„èŠå¤©é¡µé¢</li>
                <li>2. ç‚¹å‡»å·¦ä¸Šè§’çš„ ğŸ“š å›¾æ ‡æ‰“å¼€ä¼šè¯ä¾§è¾¹æ </li>
                <li>3. ç‚¹å‡»"æ–°å»ºå¯¹è¯"åˆ›å»ºæ–°çš„ä¼šè¯</li>
                <li>4. å‘é€æ¶ˆæ¯åä¼šè‡ªåŠ¨ä¿å­˜å¹¶ç”Ÿæˆä¼šè¯æ ‡é¢˜</li>
                <li>5. æ‚¬åœåœ¨ä¼šè¯ä¸Šä¼šæ˜¾ç¤ºåˆ é™¤æŒ‰é’® ğŸ—‘ï¸</li>
                <li>6. ç‚¹å‡»ä»»æ„ä¼šè¯å¯ä»¥åˆ‡æ¢åˆ°è¯¥å¯¹è¯</li>
                <li>7. å³ä¸Šè§’çš„"æ¸…ç©º"æŒ‰é’®å¯ä»¥æ¸…é™¤å½“å‰ä¼šè¯çš„æ‰€æœ‰æ¶ˆæ¯</li>
            </ol>
        </div>
    </div>

    <script>
        // æµ‹è¯•æœ¬åœ°å­˜å‚¨åŠŸèƒ½
        function testLocalStorage() {
            const result = document.getElementById('storage-result');
            try {
                // åˆ›å»ºæµ‹è¯•æ•°æ®
                const testSession = {
                    id: 'test_session_' + Date.now(),
                    title: 'æµ‹è¯•ä¼šè¯',
                    messages: [
                        { id: '1', content: 'æµ‹è¯•æ¶ˆæ¯1', isAnswer: false },
                        { id: '2', content: '**æµ‹è¯•å›å¤**', isAnswer: true }
                    ],
                    createdAt: new Date(),
                    updatedAt: new Date()
                };

                // ä¿å­˜åˆ°localStorage
                localStorage.setItem('chatSessions', JSON.stringify([testSession]));
                
                // è¯»å–éªŒè¯
                const saved = localStorage.getItem('chatSessions');
                const parsed = JSON.parse(saved);
                
                result.innerHTML = `
                    <div class="text-green-600 font-semibold">âœ… æœ¬åœ°å­˜å‚¨æµ‹è¯•æˆåŠŸ!</div>
                    <div class="text-gray-600 mt-2">
                        ä¿å­˜çš„æ•°æ®: ${JSON.stringify(parsed[0], null, 2)}
                    </div>
                `;
            } catch (error) {
                result.innerHTML = `<div class="text-red-600">âŒ æµ‹è¯•å¤±è´¥: ${error.message}</div>`;
            }
        }

        // æ¸…é™¤æœ¬åœ°å­˜å‚¨
        function clearLocalStorage() {
            const result = document.getElementById('storage-result');
            try {
                localStorage.removeItem('chatSessions');
                result.innerHTML = '<div class="text-blue-600">âœ… æœ¬åœ°å­˜å‚¨å·²æ¸…é™¤</div>';
            } catch (error) {
                result.innerHTML = `<div class="text-red-600">âŒ æ¸…é™¤å¤±è´¥: ${error.message}</div>`;
            }
        }

        // åˆ›å»ºæµ‹è¯•ä¼šè¯
        function createTestSessions() {
            const result = document.getElementById('session-result');
            try {
                const testSessions = [
                    {
                        id: 'session_1',
                        title: 'åŠ³åŠ¨åˆåŒå’¨è¯¢',
                        messages: [
                            { id: '1', content: 'åŠ³åŠ¨åˆåŒçš„åŸºæœ¬è¦ç´ æ˜¯ä»€ä¹ˆï¼Ÿ', isAnswer: false },
                            { id: '2', content: '**åŠ³åŠ¨åˆåŒçš„åŸºæœ¬è¦ç´ **åŒ…æ‹¬ï¼š\n1. ç”¨äººå•ä½ä¿¡æ¯\n2. åŠ³åŠ¨è€…ä¿¡æ¯\n3. åˆåŒæœŸé™\n4. å·¥ä½œå†…å®¹', isAnswer: true }
                        ],
                        createdAt: new Date(Date.now() - 86400000),
                        updatedAt: new Date(Date.now() - 86400000)
                    },
                    {
                        id: 'session_2', 
                        title: 'å·¥èµ„è®¡ç®—é—®é¢˜',
                        messages: [
                            { id: '3', content: 'åŠ ç­å·¥èµ„æ€ä¹ˆè®¡ç®—ï¼Ÿ', isAnswer: false },
                            { id: '4', content: 'åŠ ç­å·¥èµ„è®¡ç®—å…¬å¼ï¼š**å¹³æ—¶1.5å€**ï¼Œ**å‘¨æœ«2å€**ï¼Œ**èŠ‚å‡æ—¥3å€**', isAnswer: true }
                        ],
                        createdAt: new Date(),
                        updatedAt: new Date()
                    }
                ];

                localStorage.setItem('chatSessions', JSON.stringify(testSessions));
                result.innerHTML = '<div class="text-green-600">âœ… æµ‹è¯•ä¼šè¯åˆ›å»ºæˆåŠŸ!</div>';
            } catch (error) {
                result.innerHTML = `<div class="text-red-600">âŒ åˆ›å»ºå¤±è´¥: ${error.message}</div>`;
            }
        }

        // åˆ—å‡ºæ‰€æœ‰ä¼šè¯
        function listSessions() {
            const result = document.getElementById('session-result');
            try {
                const sessions = JSON.parse(localStorage.getItem('chatSessions') || '[]');
                if (sessions.length === 0) {
                    result.innerHTML = '<div class="text-gray-500">æš‚æ— ä¼šè¯æ•°æ®</div>';
                    return;
                }

                let html = '<div class="text-green-600 font-semibold mb-2">ğŸ“‹ å½“å‰ä¼šè¯åˆ—è¡¨:</div>';
                sessions.forEach((session, index) => {
                    html += `
                        <div class="border-l-4 border-blue-500 pl-3 mb-2">
                            <div class="font-semibold">${session.title}</div>
                            <div class="text-xs text-gray-500">
                                æ¶ˆæ¯æ•°: ${session.messages.length} | 
                                æ›´æ–°æ—¶é—´: ${new Date(session.updatedAt).toLocaleString('zh-CN')}
                            </div>
                        </div>
                    `;
                });
                
                result.innerHTML = html;
            } catch (error) {
                result.innerHTML = `<div class="text-red-600">âŒ è¯»å–å¤±è´¥: ${error.message}</div>`;
            }
        }

        // é¡µé¢åŠ è½½æ—¶æ˜¾ç¤ºå½“å‰å­˜å‚¨çŠ¶æ€
        window.addEventListener('load', function() {
            listSessions();
        });
    </script>
</body>
</html>